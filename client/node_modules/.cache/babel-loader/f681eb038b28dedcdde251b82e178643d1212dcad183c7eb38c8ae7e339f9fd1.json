{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\bhanu\\\\Desktop\\\\mern-ai-school-management\\\\client\\\\src\\\\components\\\\LiveClass\\\\LiveRoom.jsx\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect, useState } from 'react';\nimport SimplePeer from 'simple-peer';\nimport io from 'socket.io-client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SOCKET_URL = process.env.REACT_APP_SOCKET_URL || 'http://localhost:5000';\nexport default function LiveRoom() {\n  _s();\n  const myVideo = useRef();\n  const peersRef = useRef({});\n  const socketRef = useRef();\n  const [peers, setPeers] = useState([]);\n  useEffect(() => {\n    async function start() {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: true,\n        audio: true\n      });\n      myVideo.current.srcObject = stream;\n      myVideo.current.play();\n      socketRef.current = io(SOCKET_URL);\n      const ROOM_ID = window.location.pathname.split('/').pop() || 'demo-room';\n      socketRef.current.emit('join-room', ROOM_ID, 'local-user');\n      socketRef.current.on('user-joined', userId => {\n        const peer = new SimplePeer({\n          initiator: true,\n          trickle: false,\n          stream\n        });\n        peer.on('signal', data => socketRef.current.emit('signal', {\n          to: userId,\n          data\n        }));\n        peer.on('stream', remoteStream => {\n          setPeers(prev => [...prev, {\n            id: userId,\n            stream: remoteStream\n          }]);\n        });\n        peersRef.current[userId] = peer;\n      });\n      socketRef.current.on('signal', ({\n        from,\n        data\n      }) => {\n        if (peersRef.current[from]) {\n          peersRef.current[from].signal(data);\n          return;\n        }\n        const peer = new SimplePeer({\n          initiator: false,\n          trickle: false,\n          stream\n        });\n        peer.on('signal', d => socketRef.current.emit('signal', {\n          to: from,\n          data: d\n        }));\n        peer.on('stream', remoteStream => {\n          setPeers(prev => [...prev, {\n            id: from,\n            stream: remoteStream\n          }]);\n        });\n        peer.signal(data);\n        peersRef.current[from] = peer;\n      });\n    }\n    start();\n    return () => {\n      if (socketRef.current) socketRef.current.disconnect();\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Live Class\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n      ref: myVideo,\n      muted: true,\n      style: {\n        width: '400px'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }, this), peers.map(p => /*#__PURE__*/_jsxDEV(\"video\", {\n      srcObject: p.stream,\n      autoPlay: true,\n      style: {\n        width: '300px'\n      }\n    }, p.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 23\n    }, this))]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 5\n  }, this);\n}\n_s(LiveRoom, \"qrrrXQjhI+JyQPsjxGW1kDsoudA=\");\n_c = LiveRoom;\nvar _c;\n$RefreshReg$(_c, \"LiveRoom\");","map":{"version":3,"names":["React","useRef","useEffect","useState","SimplePeer","io","jsxDEV","_jsxDEV","SOCKET_URL","process","env","REACT_APP_SOCKET_URL","LiveRoom","_s","myVideo","peersRef","socketRef","peers","setPeers","start","stream","navigator","mediaDevices","getUserMedia","video","audio","current","srcObject","play","ROOM_ID","window","location","pathname","split","pop","emit","on","userId","peer","initiator","trickle","data","to","remoteStream","prev","id","from","signal","d","disconnect","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","muted","style","width","map","p","autoPlay","_c","$RefreshReg$"],"sources":["C:/Users/bhanu/Desktop/mern-ai-school-management/client/src/components/LiveClass/LiveRoom.jsx"],"sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\nimport SimplePeer from 'simple-peer';\nimport io from 'socket.io-client';\nconst SOCKET_URL = process.env.REACT_APP_SOCKET_URL || 'http://localhost:5000';\n\nexport default function LiveRoom(){\n  const myVideo = useRef();\n  const peersRef = useRef({});\n  const socketRef = useRef();\n  const [peers, setPeers] = useState([]);\n\n  useEffect(()=>{\n    async function start(){\n      const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });\n      myVideo.current.srcObject = stream;\n      myVideo.current.play();\n\n      socketRef.current = io(SOCKET_URL);\n      const ROOM_ID = window.location.pathname.split('/').pop() || 'demo-room';\n      socketRef.current.emit('join-room', ROOM_ID, 'local-user');\n\n      socketRef.current.on('user-joined', userId => {\n        const peer = new SimplePeer({ initiator: true, trickle: false, stream });\n        peer.on('signal', data => socketRef.current.emit('signal', { to: userId, data }));\n        peer.on('stream', remoteStream => {\n          setPeers(prev=>[...prev, { id: userId, stream: remoteStream }]);\n        });\n        peersRef.current[userId] = peer;\n      });\n\n      socketRef.current.on('signal', ({ from, data }) => {\n        if (peersRef.current[from]) {\n          peersRef.current[from].signal(data);\n          return;\n        }\n        const peer = new SimplePeer({ initiator: false, trickle: false, stream });\n        peer.on('signal', d => socketRef.current.emit('signal', { to: from, data: d }));\n        peer.on('stream', remoteStream => {\n          setPeers(prev=>[...prev, { id: from, stream: remoteStream }]);\n        });\n        peer.signal(data);\n        peersRef.current[from] = peer;\n      });\n    }\n    start();\n    return ()=>{ if (socketRef.current) socketRef.current.disconnect(); };\n  },[]);\n\n  return (\n    <div>\n      <h2>Live Class</h2>\n      <video ref={myVideo} muted style={{ width: '400px' }} />\n      {peers.map(p => <video key={p.id} srcObject={p.stream} autoPlay style={{ width: '300px' }} />)}\n    </div>\n  )\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}